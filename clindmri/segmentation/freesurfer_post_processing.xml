<?xml version="1.0" encoding="UTF-8"?>
<pipeline version="1.0">
    <docstring>
        Freesurfer post processings
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~

        Performs all the FreeSurfer cortical reconstruction post
        processings:

        * Group of subjects statistical summaries: subcortial (aseg) or pial
          (aparc)
        * Nifti conversions: aseg - aparc+aseg - wm - t1
        * White mesh conversion.
        * Quality checks: segmentations/t1 overlays - cortex parcellation
    </docstring>
    <units>
        <unit name="aparc_stats">
            <module>clindmri.segmentation.freesurfer.aparcstats2table</module>
            <set name="output_directory" value="None"/>
        </unit>
        <unit name="aseg_stats">
            <module>clindmri.segmentation.freesurfer.asegstats2table</module>
            <set name="output_directory" value="None"/>
        </unit>
        <unit name="nifti_aparc_aseg">
            <module>clindmri.segmentation.freesurfer.mri_convert</module>
            <set name="output_directory" value="None"/>
            <set name="interpolation" value="'nearest'"/>
            <set name="regex" value="'*/mri/aparc+aseg.mgz'"/>
        </unit>
        <unit name="nifti_aseg">
            <module>clindmri.segmentation.freesurfer.mri_convert</module>
            <set name="output_directory" value="None"/>
            <set name="interpolation" value="'nearest'"/>
            <set name="regex" value="'*/mri/aseg.mgz'"/>
        </unit>
        <unit name="nifti_wm">
            <module>clindmri.segmentation.freesurfer.mri_convert</module>
            <set name="output_directory" value="None"/>
            <set name="interpolation" value="'nearest'"/>
            <set name="regex" value="'*/mri/wm.mgz'"/>
        </unit>
        <unit name="nifti_t1">
            <module>clindmri.segmentation.freesurfer.mri_convert</module>
            <set name="output_directory" value="None"/>
            <set name="interpolation" value="'interpolate'"/>
            <set name="regex" value="'*/mri/rawavg.mgz'"/>
        </unit>
        <unit name="white_resampling">
            <module>clindmri.segmentation.freesurfer.resample_cortical_surface</module>
            <set name="output_directory" value="None"/>
            <set name="surface_name" value="'white'"/>
            <set name="orders" value="[4]"/>
        </unit>
        <unit name="pial_resampling">
            <module>clindmri.segmentation.freesurfer.resample_cortical_surface</module>
            <set name="output_directory" value="None"/>
            <set name="surface_name" value="'pial'"/>
            <set name="orders" value="[4]"/>
        </unit>
        <unit name="conformed_to_native">
            <module>clindmri.segmentation.freesurfer.conformed_to_native_space</module>
            <set name="output_directory" value="None"/>
        </unit>
        <unit name="white_convert">
            <module>clindmri.segmentation.freesurfer.surf_convert</module>
            <set name="output_directory" value="None"/>
            <set name="rm_orig" value="True"/>
        </unit>
        <unit name="pial_convert">
            <module>clindmri.segmentation.freesurfer.surf_convert</module>
            <set name="output_directory" value="None"/>
            <set name="rm_orig" value="True"/>
        </unit>
        <unit name="qc" qc="True">
            <module>clindmri.segmentation.freesurfer.qc</module>
            <set name="output_directory" value="None"/>
            <set name="asegfiles" value="[]"/>
            <set name="wmfiles" value="[]"/>
        </unit>
    </units>
    <links>
        <link source="fsdir" destination="aparc_stats.fsdir"/>
        <link source="fsconfig" destination="aparc_stats.fsconfig"/>
        <link source="aparc_stats.statfiles" destination="aparc_statfiles"/>

        <link source="fsdir" destination="aseg_stats.fsdir"/>
        <link source="fsconfig" destination="aseg_stats.fsconfig"/>
        <link source="aseg_stats.statfiles" destination="aseg_statfiles"/>

        <link source="fsdir" destination="nifti_aparc_aseg.fsdir"/>
        <link source="fsconfig" destination="nifti_aparc_aseg.fsconfig"/>
        <link source="nifti_aparc_aseg.niftifiles" destination="aparc_asegfiles"/>

        <link source="fsdir" destination="nifti_aseg.fsdir"/>
        <link source="fsconfig" destination="nifti_aseg.fsconfig"/>
        <link source="nifti_aseg.niftifiles" destination="asegfiles"/>

        <link source="fsdir" destination="nifti_t1.fsdir"/>
        <link source="fsconfig" destination="nifti_t1.fsconfig"/>
        <link source="nifti_t1.niftifiles" destination="t1files"/>

        <link source="fsdir" destination="nifti_wm.fsdir"/>
        <link source="fsconfig" destination="nifti_wm.fsconfig"/>
        <link source="nifti_wm.niftifiles" destination="wmfiles"/>

        <link source="fsdir" destination="white_resampling.fsdir"/>
        <link source="fsconfig" destination="white_resampling.fsconfig"/>
        <link source="white_resampling.resamplefiles" destination="whitefiles"/>

        <link source="fsdir" destination="pial_resampling.fsdir"/>
        <link source="fsconfig" destination="pial_resampling.fsconfig"/>
        <link source="pial_resampling.resamplefiles" destination="pialfiles"/>

        <link source="fsdir" destination="conformed_to_native.fsdir"/>
        <link source="fsconfig" destination="conformed_to_native.fsconfig"/>
        <link source="conformed_to_native.trffiles" destination="trffiles"/>

        <link source="fsdir" destination="white_convert.fsdir"/>
        <link source="fsconfig" destination="white_convert.fsconfig"/>
        <link source="nifti_t1.niftifiles" destination="white_convert.t1files"/>
        <link source="white_resampling.resamplefiles" destination="white_convert.surffiles"/>
        <link source="white_convert.csurffiles" destination="whitefiles"/>

        <link source="fsdir" destination="pial_convert.fsdir"/>
        <link source="fsconfig" destination="pial_convert.fsconfig"/>
        <link source="nifti_t1.niftifiles" destination="pial_convert.t1files"/>
        <link source="pial_resampling.resamplefiles" destination="pial_convert.surffiles"/>
        <link source="pial_convert.csurffiles" destination="pialfiles"/>

        <link source="nifti_t1.niftifiles" destination="qc.t1files"/>
        <link source="nifti_wm.niftifiles" destination="qc.wmfiles"/>
        <link source="nifti_aseg.niftifiles" destination="qc.asegfiles"/>
        <link source="white_convert.csurffiles" destination="qc.whitefiles"/>
        <link source="qc.qcfiles" destination="qcfiles"/>
    </links>
    <positions>
        <position unit="inputs" x="46" y="195"/>
        <position unit="conformed_to_native" x="230" y="-310"/>
        <position unit="aparc_stats" x="230" y="-18"/>
        <position unit="aseg_stats" x="230" y="-160"/>
        <position unit="nifti_aseg" x="230" y="127"/>
        <position unit="nifti_aparc_aseg" x="230" y="377"/>
        <position unit="nifti_wm" x="230" y="621"/>
        <position unit="nifti_t1" x="230" y="868"/>
        <position unit="white_resampling" x="230" y="1112"/>
        <position unit="pial_resampling" x="230" y="1300"/>
        <position unit="white_convert" x="498" y="-251"/>
        <position unit="pial_convert" x="498" y="50"/>
        <position unit="qc" x="726" y="-2"/>
        <position unit="outputs" x="874" y="327"/>
    </positions>
    <zoom level="0.25"/> 
</pipeline>
